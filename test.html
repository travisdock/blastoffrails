<form id="subscribe-form">
  <input type="email" name="email" placeholder="Your email" required />

  <input type="text" name="website" style="display:none" autocomplete="off">

  <!-- Timestamp -->
  <input type="hidden" name="ts" value="" id="ts">

  <button type="submit">Subscribe</button>
</form>

<p id="message"></p>

<script>
  // Set timestamp on page load
  document.getElementById("ts").value = Date.now();

  document.getElementById("subscribe-form").addEventListener("submit", async (e) => {
    e.preventDefault();

    const form = e.target;
    const email = form.email.value;
    const website = form.website.value;
    const ts = form.ts.value;

    const res = await fetch("https://mailerlite-api.travisdock.workers.dev/subscribe", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, ts, website }),
    });

    const data = await res.json();
    const message = document.getElementById("message");
    message.textContent = res.ok ? "✅ Thanks for subscribing!" : "❌ Error: " + data.error;
  });
</script>

